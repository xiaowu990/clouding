# Nginx简介
Nginx (” engine x")是一个高性能的HTTP和反向代理服务器，特点是占有内存少，并发能力强，事实上nginx的并发能力确实在同类型的网页服务器中表现较好。
Nginx专为性能优化而开发，性能是其最重要的考量，实现上非常注重效率， 能经受高负载的考验，有报告表明能支持高达50, 000个并发连接数。
# 代理相关概念
## 代理
代理也被叫做网络代理，是一种比较特殊的网络服务，允许一个终端（通常指客户端）通过这个服务与另一个终端（通常指服务器端）进行非直接的连接。例如：一些网关、路由器等网络设备都具备网络代理的功能。代理服务有利于保障网络终端的隐私或者安全，可以在一定程度上阻止网络攻击（==因为通过代理，可以隐藏真正的服务器端/客户端）。==

## 代理服务器
1. 基本定义
代理服务器是一种计算机网络服务器，充当客户端和目标服务器之间的中介。它接收来自客户端的请求，并将请求转发到目标服务器上，然后将响应返回给客户端。在这个过程中，代理服务器可以进行一些额外的处理，例如缓存请求和响应、过滤请求和响应、记录访问日志等。代理服务器可以分为正向代理和反向代理两种类型。

2. 代理请求过程
客户端首先根据代理服务器所使用的代理协议，与代理服务器创建连接，接着按照协议请求对目标服务器创建连接、或者获得目标服务器的指定资源

## 代理协议
* 主要是两种：HTTP协议和SOCKS协议
* 代理协议指的是客户端和代理服务器之间进行通信和协商的规则和约定。不同类型的代理服务器可能会使用不同的代理协议，
* 例如HTTP代理服务器通常使用HTTP协议进行通信，而SOCKS代理服务器则使用SOCKS协议进行通信。
* 代理协议通常定义了以下内容：
1. 代理服务器的地址和端口号；
2. 客户端请求和代理服务器响应的数据格式和协议；
3. 客户端和代理服务器之间的身份验证方式；
4. 代理服务器的功能和特性，例如缓存、安全性、加密等；
5. 异常处理和错误码定义。
## 代理特点
1. 映射：使用代理，多个用户使用代理访问外界时，只映射为一个IP地址。
2. 过滤：可以对外界或内部的Internet地址进行过滤。
3. 权限：外界不能直接访问到内部网，同时限制内部网对外部的访问权限。
## 正/反代理区别
* 正向代理是代理客户端，比如vpn 
* 反向代理是代理服务器，比如nginx 
* 最核心的不同在于代理的对象不同 代理哪端便可以隐藏哪端，隐藏后，也就避免暴露自己主服务器的位置
**正向代理中，proxy和client同属一个LAN，对server透明；  
反向代理中，proxy和server同属一个LAN，对client透明。**
![[Pasted image 20230730104118.png]]
# 正向代理
## 基本概念
正向代理（Forward Proxy）是代理服务器的一种形式，它代表客户端向其他服务器发送请求。正向代理通常用于保护客户端的身份和位置，并且可以缓存请求，以提高响应速度。
在浏览器（客户端）配置代理服务器，通过代理服务器进行互联网的访问
![[Pasted image 20230730091249.png]]、![[Pasted image 20230730091458.png]]
## 详解
* 通常所说的代理就是正向代理
* 流程：正向代理时，由客户端发送对某一个目标服务器的请求，代理服务器在中间将请求转发给该目标服务器，目标服务器将结果返回给代理服务器，代理服务器再将结果返回给客户端。  
* 使用正向代理时，客户端是需要配置代理服务的地址、端口、账号密码（如有）等才可使用的。
* ==客户端知道目标服务器的地址，但是目标服务器不知道客户端地址，只知道代理服务器的地址==
* 应用：
	1. 对于不能直接访问的服务器，可以通过代理服务器进行访问，比如谷歌等
	2. 隐藏客户端地址
	3. 用户访问控制
	4. 过滤内容等
![[Pasted image 20230730102305.png]]



# 反向代理
## 基本概念
反向代理服务器位于用户与目标服务器之间，==但是对于用户而言==，反向代理服务器就相当于目标服务器，即用户直接访问反向代理服务器就可以获得目标服务器的资源。同时，用户不需要知道目标服务器的地址，也无须在用户端作任何设定。反向代理服务器通常可用来作为Web加速，即使用反向代理作为Web服务器的前置机来降低网络和服务器的负载，提高访问效率。
![[Pasted image 20230730092639.png]]

![[Pasted image 20230730092243.png]]

## 详解
* 课户端只会得知代理服务器的IP地址，而不知道在代理服务器后面的服务器集群的存在。
* 流程：由客户端发起对代理服务器的请求，代理服务器在中间将请求转发给某一个服务器，服务器将结果返回给代理服务器，代理服务器再将结果返回给客户端。
* ==隐藏了目标服务器的IP地址==，客户端只会得知代理服务器的IP地址，而不知道在代理服务器后面的服务器集群的存在。
* 应用
	1. 负载均衡
	2. 提示服务器安全性等
![[Pasted image 20230730102841.png]]

# 负载均衡
1. <font color="#c00000">出现的背景</font>
客户端发送多个请求到服务器，服务器处理请求，有一些可能要与数据库进行交互，服务器处理完毕后，再将结果返回给客户端。
这种架构模式对于早期的系统相对单一，并发请求相对较少的情况下是比较适合的，成本也低。但是随着信息数量的不断增长，访问量和数据量的飞速增长，以及系统业务的复杂度增加，这种架构会造成服务器相应客户端的请求日益缓慢，并发量特别大的时候，还容易造成服务器直接崩溃。很明显这是由于服务器性能的瓶颈造成的问题，那么如何解决这种情况呢？
我们首先想到的可能是升级服务器的配置，比如提高 CPU 执行频率，加大内存等提高机器的物理性能来解决此问题，但是我们知道摩尔定律的日益失效，硬件的性能提升已经不能满足日益提升的需求了。最明显的一个例子，天猫双十一当天，某个热销商品的瞬时访问量是极其庞大的，那么类似上面的系统架构，将机器都增加到现有的顶级物理配置，都是不能够满足需求的。那么怎么办呢？
上面的分析我们去掉了增加服务器物理配置来解决问题的办法，也就是说纵向解决问题的办法行不通了，那么横向增加服务器的数量呢？==这时候集群的概念产生了，单个服务器解决不了，我们增加服务器的数量，然后将请求分发到各个服务器上，将原先请求集中到单个服务器上的情况改为将请求分发到多个服务器上，将负载分发到不同的服务器，也就是我们所说的负载均衡 。==

2. <font color="#c00000">基本概念</font>
* 负载：计算机系统中正在运行的任务数或请求量。
* 负载均衡：增加服务器的数量，然后将请求分发到各个服务器上，将原先请求集中到单个服务器上的情况改为将请求分发到多个服务器上，==将负载分发到不同的服务器，也就是我们所说的**负载均衡**==
![[Pasted image 20230730094354.png]]
# 动静分离
为了加快网站的解析速度，可以把 动态页面 和 静态页面 由不同的服务器来解析，加快解析速度。降低原来单个服务器的压力。

![[Pasted image 20230730095627.png]]

