# 用户与用户组
## 用户
Linux 是多用户多任务操作系统，换句话说，Linux 系统支持多个用户在同一时间内登陆，不同用户可以执行不同的任务，并且互不影响。
不同用户具有不问的权限，毎个用户在权限允许的范围内完成不间的任务，Linux 正是通过这种权限的划分与管理，实现了多用户多任务的运行机制。
## 用户组
用户组可以帮助管理员更好地管理系统资源和文件目录的权限。同时，还可以简化用户管理和访问控制的管理。定义用户组，简化了对用户的管理工作。
## 用户与用户组的关系
每个用户都可以属于多个用户组，而每个用户组可以包含多个用户
## /home家目录(主目录)
1. 定义：
2. 注意点
* 每个用户都有且只有一个独立的家目录，每个用户组也可以有一个独立的家目录。
* 当==普通用户登录==时，会自动进入到自己的家目录中。
* 当==root==用户登录时，只会进入root目录中
1. 实例分析
* 当创建一个用户后，默认自动创建和该用户同名的家目录。如创建了用户s后，自动创建目录/home/s
* 给创建的用户指定目录：useradd -d 指定目录 新的用户名（给新创建的用户指定家目录，用户名改不改都行）
# 用户
## 添加用户
1. useradd [选项] 用户名
在centos中useradd和adduser是没有区别的，但是在ubuntu中，useradd和adduser是有区别的
2. 选项
- -c comment 指定一段注释性描述。
- -d 目录 指定用户主目录，如果此目录不存在，则同时使用-m选项，可以创建主目录。
- -g 用户组 指定用户所属的用户组。
- -G 用户组，用户组 指定用户所属的附加组。
- -s Shell文件 指定用户的登录Shell。
- -u 用户号 指定用户的用户号，如果同时有-o选项，则可以重复使用其他用户的标识号。
## 修改账号
1. usermode [选项] 用户名
* 修改用户账号就是根据实际情况更改用户的有关属性，如用户号、主目录、用户组、登录Shell等。
* 常用的选项包括`-c, -d, -m, -g, -G, -s, -u以及-o等`，这些选项的意义与`useradd`命令中的选项一样，可以为用户指定新的资源值。另外，有些系统可以使用选项：-l 新用户名
## 指定或修改密码（用户密码就是用户口令）
1. passwd [选项] 用户名
2. 选项
- -l 锁定密码，即禁用账号
- -u 口令解锁，用于解锁一个用户账户（如果之前被锁定了的话）
- -d 使账号无口令。即不需要密码就可以登录
- -f 强迫用户下次登录时修改密码
## 删除用户
1. 只删除用户，不删除用户所在主目录：userdel 用户名
2. 删除用户和其所在的主目录：userdel -r 用户名
## 查询用户信息
格式：id 用户名



![[Pasted image 20230719174357.png]]
## 切换用户
ubuntu中：su - 用户名
centos中：su - 用户名
* 返回原来的用户：exit
* 权限高的用户切换到权限低的用户时不需要输入密码，反之需要
### 出现的一些问题
* 当一些用户不能sudo权限时，要在root下执行以下命令
root@VM-4-8-ubuntu:~# usermod -aG sudo bob
* 更改用户所属组，要在root情况下，可以加上sudo即可
![[Pasted image 20230722110634.png]]

## 查看当前用户
whoami
查看当前系统当前账号的用户名。可通过cat /etc/passwd查看系统用户信息。

```bash
python@ubuntu:~/test$ whoami
python
```
## 查看登录用户
查看登录用户：who
who命令用于查看当前所有登录系统的用户信息。

# 用户组
## 添加用户组
1. useradd -g 用户组 用户名：在创建用户时直接分配组，创建用户时如果没指定对应的用户组，则会创建一个和用户名同名的用户组
2 . groupadd  [选项] 用户组名。不使用任何选项表示在已有最大组标识号的基础上加一
- -g GID 指定新用户组的组标识号（GID）。
- -o 一般与-g选项同时使用，表示新用户组的GID可以与系统已有用户组的GID相同。
## 删除用户组
1. groupdel 用户组名
## 修改用户组
1. groupmod [选项] 用户组     或     usermod -g 新用户组  用户名
2. 选项
- -g GID 为用户组指定新的组标识号。
- -o 与-g选项同时使用，用户组的新GID可以与系统已有用户组的GID相同
- -n新用户组 将用户组的名字改为新名字
### 修改用户的组
1. usermode -g 新用户组 用户名

## 查看一个用户组中包含哪些用户
1. cat /etc/group | grep usergroup
2. cat /etc/passwd | grep 1006

![[Pasted image 20230829195348.png]]


# 与账户有关的系统文件
使用cat或者vim
## /etc/passwd文件
用户的配置文件，记录用户的各种信息
==用户名:口令:用户标识号:组标识号:注释性描述:主目录:登录Shell==

root:x:0:0:Superuser:/:
daemon:x:1:1:System daemons:/etc:
bin:x:2:2:Owner of system commands:/bin:
sys:x:3:3:Owner of system files:/usr/sys:
adm:x:4:4:System accounting:/usr/adm:
uucp:x:5:5:UUCP administrator:/usr/lib/uucp:
auth:x:7:21:Authentication administrator:/tcb/files/auth:
cron:x:9:16:Cron daemon:/usr/spool/cron:
listen:x:37:4:Network daemon:/usr/net/nls:
lp:x:71:18:Printer administrator:/usr/spool/lp:
sam:x:200:50:Sam san:/home/sam:/bin/sh

从上面的例子我们可以看到，/etc/passwd中一行记录对应着一个用户，每行记录又被冒号(:)分隔为7个字段，其格式和具体含义如下：

![[Pasted image 20230829202212.png]]


## /etc/shadow文件
口令的配置文件，密码的登录信息，是加密的
每行的含义:==登录名:加密口令:最后一s次修改时间:最小时间间隔:最大时间间隔:警告时间:不活动时间:失效时间:标志==
`daemon:*:17834:0:99999:7:::`

>[!note] 
>1. 用户名（Username）：这是用户的登录名称。在示例中，用户名为 `daemon`。
>2. 密码（Password）：在过去，此字段中存储用户的密码。然而，现在密码通常以哈希形式存储在 `/etc/shadow` 文件中。在示例中，密码字段为 `*`，表示密码存储在 `/etc/shadow` 文件中。
>3. 上次修改密码的日期（Last password change）：这是用户上次修改密码的日期，表示为自 1970 年 1 月 1 日以来的天数。在示例中，上次密码更改日期为 `17834`。
    >4. 密码过期时间（Password expiration）：这是密码的过期时间，以天数表示。在示例中，密码过期时间为 `0`，表示密码永不过期。
    >5. 密码过期前的警告期（Password warning）：这是密码过期前给予用户的警告天数。在示例中，密码过期前的警告期为 `99999`，表示在密码过期之前不会给出警告。
    >6. 密码失效期限（Password inactive）：这是用户密码失效的天数。在示例中，密码失效期限为 `7`，表示用户在密码过期后的 `7` 天内可以使用旧密码进行登录，超过该期限后，旧密码将失效。
    >7. 保留字段（Reserved field）：这是保留字段，目前没有特定的用途。在示例中，保留字段为空。


![[Pasted image 20230829202005.png]]
## /etc/group文件
组group的配置文件，记录linux包含的组的信息。
以usergroup:x:1006为例
- `usergroup`：这是用户组的名称。它标识了该用户组在系统中的唯一性。
    
- `x`：这是用户组密码字段。在过去，用户组密码是存储在 `/etc/group` 文件中的，但现在大多数 Linux 系统将用户组密码存储在 `/etc/gshadow` 文件中。因此，这个字段通常是占位符 `x`。
    
- `1006`：这是用户组的 GID（Group ID）。GID 是系统用于标识用户组的数字标识符。

![[Pasted image 20230829195656.png]]

