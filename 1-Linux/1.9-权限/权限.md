#  权限介绍
![[Pasted image 20230723094602.png]]

-rwxrw-r-- 1 root root 1213 Feb 2 09:39 abc.txt  ：一共包含了七组信息
## rwx
 第一组
	1. 第一个字符代表文件类型： 文件 (-),目录(d),链接(l) 
	* 其余字符每 3 个一组(rwx) 读(r) 写(w) 执行(x) 
	2. 第一组 rwx : 文件拥有者的权限是读、写和执行 
	3. 第二组 rw- : 与文件拥有者同一组的其他用户的权限是读、写但不能执行
	4. 第三组 r-- : 与文件拥有者不同组的其他用户的权限是读不能写和执行

rwx在文件和目录的区别
>[!note] 文件

作用到文件
1) [ r ]代表可读(read): 可以读取文件内容
2) [ w ]代表可写(write): 可以修改,但是不代表可以删除该文件,删除一个文件的前提条件是对该文件所在的目录有写权限，才能删除该文件. 
3) [ x ]代表可执行(execute):具有执行文件的权限

>[!note] 目录

作用到目录
2) [ r ]代表可读(read): 可以浏览目录
3) [ w ]代表可写(write): 可以修改,目录内创建+删除+重命名+移动 操作
4) [ x ]代表可执行(execute):可以进入该目录

## 其他
1. 第二组表示文件的链接个数。这里的1表示链接数为1
2. 第三组表示文件的所有者
3. 第四组表示文件所属的组
4. 第组五表示：
	1. 如果是文件：则表示文件大小
	2. 如果是目录：则是4096（难点）
5. 第六组：表示文件最后的修改时间
6. 第七组：表示文件名
# 修改权限
通过chmod修改文件或目录的权限
## 字符表示的访问权限，+ 、-、= 变更权限
* u:所有者 
* g:所有组 
* o:其他用户
* a:所有用户 (u、g、o 的总和)，是系统默认值

+：添加权限
-：取消权限
=：授予权限，会覆盖之前的权限

1) chmod u=rwx,g=rx,o=x 文件/目录名 
2) chmod o+w 文件/目录名 
3) chmod a-x 文件/目录名

案例1. 给c.txt文件 的所有者读写执行的权限，给所在组执行权限，给其它组执行权限。
![[Pasted image 20230723112016.png]]
## 八进制数字表示的访问权限
* r:4
* w:2
* x:1
* 没有任何权限：0
rwx=4+2+1=7
chmod u=rwx,g=rx,o=x 文件/目录名   等价于   ==chmod 751 文件/目录名 ==

案例：将 /home/abc.txt 文件的权限修改成 rwxr-xr-x, 使用给数字的方式实现
rwx = 4+2+1 = 7 
r-x = 4+1=5 
r-x = 4+1 =5 
指令：chmod 755 /home/abc.txt
![[Pasted image 20230723123619.png]]
# 修改文件所有者
* chown newowner file 改变文件的所有者 
         * -R参数表示更改一个目录下所有文件的拥有者
* chown newowner:newgroup file ==同时==改变文件的所有者和所有组
==选项：-R 如果是目录 则使其下所有子文件或目录递归生效==

案例演示
![[Pasted image 20230723150621.png]]

# 修改文件所在组
chgrp newgroup file 改变文件的所有组

# umask默认权限
umask默认权限时linux权限的一种，主要让linux中新建的文件和目录具有默认权限。
直接输入umask得出数字显示的文件和目录的初始权限，加上参数-S，使用字母表示的
* root用户系统默认是0022，其他普通用户系统默认是0002

>[!info]
>其中第一个数字  “0”，代表的是文件的特殊权限（setUID，SetGID，Sticky BiT），后面三位数字才是真正的umask权限
>


![[Pasted image 20230831163515.png]]


# 🔱文件特殊权限
## 🍊SetUID
简单来说setuid的作用是将文件执行时的权限更换为文件拥有者的权限，而不是当前用户所拥有的权限。

给特定文件设置setuid权限

* 前提：只有当文件的所有者具有执行权限时，才能设置setuid权限
* 如果该属主权限位上有执行权限，则会在属主权限位的执行权限上写个s（小写）； 如果该属主权限位上没有执行权限，则会在属主权限位的执行权限上写个S（大写）。
方法一、通过字母
格式：sudo chmod u+s filename
![[Pasted image 20230831185259.png]]

方法二、通过数字

格式：chmod 4XXX filename
`XXX`是其他权限位的数字表示（用户权限、所属组权限、其他用户权限）。
所以可以设置setuid权限的同时设置文件的读写执行权限。
如果只设置setuid权限，写4000即可
![[Pasted image 20230831185449.png]]


> [!note] 
> 可以发现文件2权限的 x 变为了 s ，说明setuid已经被设置，之后任何用户执行这个文件的时候（用户需要有该文件的执行权限），都会以root的权限运行（文件的owner是root用户）。所以，针对一个需要被很多user以root权限执行的文件，我们可以通过setuid来进行操作，这样就不必为所有的user都使用sudo指令。

## 🍒SetGID
同理，当s标志在属主的x位置时是setuid，那么当s标志在属组的x位置时是setgid，简称SGID
[linux sgid用法,Linux SetGID（SGID）文件特殊权限用法详解_喂今天救公主了吗的博客-CSDN博客](https://blog.csdn.net/weixin_30082367/article/details/116888774?ops_request_misc=&request_id=&biz_id=102&utm_term=setgid&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-6-116888774.142^v93^insert_down1&spm=1018.2226.3001.4187)

设置SetGID
使用2xxx

### 对文件


### 对目录
## 🥦Sticky BIT

只对目录有效
当目录设置了粘滞位时，只有目录的所有者、文件的所有者和超级用户（通常是root用户）才能够删除或重命名该目录中的文件。其他用户无法删除或重命名不属于自己的文件，即使对于目录有写权限也不行。
> 粘滞位通常用于公共目录，例如/tmp目录，以防止普通用户删除其他用户创建的文件。它可以确保文件只能由创建者自己或管理者删除，从而提供了一定的安全性和数据保护。

设置：使用1xxx

# 🔺chattr文件系统属性权限
chattr概述：凌驾于r、w、x、suid、sgid之上的权限。常用于防止系统中某个关键文件被修改：
chattr：设置特殊权限 
格式：chattr 选项 文件名

> [!warning] chattr命令的常用选项包括：
> 
> - +：添加属性
> - -：移除属性
> - =：仅设置指定的属性，移除其他属性
> 
> 以下是一些chattr常用的属性：
> 
> 1. i（immutable）：将文件设置为不可修改。一旦文件被设置为不可修改，任何用户，包括root用户，都不能修改、重命名、删除或创建硬链接。只有通过移除不可修改属性后，才能对文件进行修改。
>     
> 2. a（append-only）：将文件设置为只能追加内容。设置后，文件只能以追加模式打开，已存在的内容无法修改或删除，只能在文件末尾追加内容。
>     
> 3. d（no dump）：将文件设置为不会被备份。在进行系统备份时，通常会跳过具有no dump属性的文件。
>     
> 4. s（secure deletion）：启用安全删除。当文件被删除时，实际上并不立即释放文件占用的磁盘空间，而是通过覆盖文件内容为零来确保文件内容无法恢复。
>     
> 5. c（compression）：启用透明压缩。当文件被写入时，文件系统会自动对其进行压缩，以节省磁盘空间。




lsattr：查看特殊权限

![[Pasted image 20230831192411.png]]


