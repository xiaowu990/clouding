# 基本介绍
## 原理与概述
原理示意图，crontab 进行定时任务的设置。
![[1Linux云计算运维/1-Linux/1.10-任务调度/attachements/3.7定时调度原理.jpg]]


2. 概述
* 任务调度：是指系统在某个时间执行的特定的命令或程序。
* 任务调度分类：
	1. 系统工作：有些重要的工作必须周而复始地执行。如病毒扫描等
	2. 个别用户工作：个别用户可能希望执行某些程序，比如对mysql 数据库的备份。

## 语法与参数细节
![[Pasted image 20230823204421.png]]

3. 基本语法
crontab [选项]
选项说明如下
- -e：编辑crontab定时任务
- -i：查询crontab任务
- -r：删除当前用户所有的crontab任务
- -l：列出当前用户的全部定时任务
- service crond restart：重启任务调度

4. 参数细节说明

![[Pasted image 20230830095553.png]]

不写具体的月，表示每个月都执行，不写具体的星球，表示每个星期都执行。

5. 特殊符号说明

- `*：`代表任何时间。比如第一个*就代表一小时中每分钟都执行一次的意思。
- `,：`代表不连续的时间。比如“0 8,12,16 * * *命令”，就代表在每天的8点0分，12点0分，16点0分都执行一次命令。
- `-：`代表连续的时间范围。比如“0 5 * * 1-6命令”，代表在周一到周六的凌晨5点0分执行命令。
- `/n：`代表每隔多久执行一次。比如“*/10 * * * * 命令”，代表每隔10分钟就执行一遍命令。

![[Pasted image 20230830095824.png]]

6. 特定事件执行任务案例
![[Pasted image 20230723155731.png]]


# 案例
## 快速入门
1. 任务要求
设置任务调度文件：/etc/crontab 设置个人任务调度。
执行 crontab –e 命令。 
接着输入任务到调度文件 如：\*/1 * * * * ls  –l /etc/ >> /tmp/to.txt
意思说每小时的每分钟执行 ls –l /etc/ >> /tmp/to.txt 命令

2. 步骤
1) crontab -e 
2) / 1 * * * * ls -l /etc >> /tmp/to.txt
3) 当保存退出后就程序。 
4) 在每一分钟都会自动的调用 ls -l /etc >> /tmp/to.txt

![[Pasted image 20230723192835.png]]
![[Pasted image 20230723192854.png]]
![[Pasted image 20230723192914.png]]
## 案例1
每隔 1 分钟，就将当前的日期信息，追加到/tmp/mydate文件中
1) 先编写一个文件 /home/mytask1.sh 
 `date >> /tmp/mydate `
 
1) 给 mytask1.sh 一个可以执行权限 chmod 744 /home/mytask1.sh 
2) crontab -e 
3) `*/1 * * * * /home/mytask1.sh `
4) 成功
## 案例2
每隔 1 分钟， 将当前日期和日历都追加到/home/mycal 文件中
1) 先编写一个文件 /home/mytask2.sh 
`date >> /tmp/mycal `
`cal >> /tmp/mycal `
3) 给 mytask1.sh 一个可以执行权限 chmod 744 /home/mytask2.sh 
4) crontab -e 
5) \*/1 * * * * /home/mytask2.sh
## 案例3
每天凌晨 2:00 将 mysql 数据库testdb ，备份到文件中mydb.bak。
1) 先编写一个文件 /home/mytask3.sh 
`/usr/local/mysql/bin/mysqldump -u root -proot testdb > /tmp/mydb.bak `
3) 给 mytask3.sh 一个可以执行权限 
chmod 744 /home/mytask3.sh 
4) crontab -e 
5) 0 2 * * * /home/mytask3.sh 
6) 成功

## 视频教程链接如下
[040_尚硅谷_Linux实操篇_任务调度应用实例_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1dW411M7xL/?p=40&spm_id_from=pageDriver&vd_source=68f2caee9405e8c7722512f6a0535511)

